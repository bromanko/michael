---
id: mwbp-7792
status: closed
deps: []
links: []
created: 2026-01-30T20:24:56Z
type: feature
priority: 2
assignee: Brian Romanko
---
# Add CSRF protection to API endpoints

All three POST endpoints (/api/parse, /api/slots, /api/book) lack CSRF tokens. Any site can trigger requests if a user has the app open. Requires backend work (generate token via cookie or meta tag) and frontend work (send token as request header in Api.elm).


## Notes

**2026-02-08T19:55:37Z**

Implemented CSRF protection for booking POST endpoints using server-generated token. Added GET /api/csrf-token to provide token, backend header validation (X-CSRF-Token) wrapper for /api/parse, /api/slots, /api/book returning 403 on missing/invalid token. Booking Elm app now fetches token at startup, stores it in model, sends header on parse/slots/book requests, and gracefully errors if token bootstrap fails. Verified with selfci check.
